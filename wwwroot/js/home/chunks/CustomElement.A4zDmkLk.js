import{r as l,j as e,R as Z}from"../index.DKk2s01l.js";import{L as le,S as oe,P as ie}from"./Stack.eFpAXuqd.js";import{a as ce,u as de}from"./useTablaVirtualizadaCustom.YaVcVRmy.js";const ue=g=>{const[f,x]=l.useState(""),[o,t]=l.useState(!1),[j,L]=l.useState({data:[],campos:[],items:[]}),O=l.useRef(j),T=l.useRef(o);return O.current=j,T.current=o,{handleClick:()=>{let M=!1;const V=[],H=[],q=[];Array.isArray(g.current)&&(g.current=g.current.filter((i,r,d)=>i&&d.indexOf(i)===r)),Array.from(new Set(Object.values(g.current).filter(i=>i instanceof HTMLElement))).forEach(i=>{if(!i)return;const r=i.querySelector("input, select, textarea")||i;if(r?.type?.toLowerCase()==="hidden"||i?.type?.toLowerCase()==="hidden"||r?.getAttribute("type")==="hidden"||i?.getAttribute("type")==="hidden"||i.querySelector('input[type="hidden"]'))return;const d=r.dataset?.value??"",b=r.dataset?.valor??"",p=r.dataset?.campo??"",k=r.dataset?.item??"";if(d!==b&&!p.startsWith("100")&&(V.push(d),H.push(p),q.push(k)),r?.dataset.required==="true"||r?.required){let s=d;(r.type==="checkbox"||r.type==="radio")&&(s="ok"),r.multiple&&typeof s=="string"&&(s=s.split(",").map(v=>v.trim()).filter(v=>v).join(",")),!s||s.toString().trim()===""?(M=!0,i.classList.add("border-2","border-red-500","rounded-md")):i.classList.remove("border-2","border-red-500","rounded-md")}});const B=[],R=[],$=[];H.forEach((i,r)=>{i&&!B.includes(i)&&(B.push(i),R.push(V[r]),$.push(q[r]))});const w={data:R,campos:B,items:$};L(w),O.current=w,M?(t(!1),T.current=!1,x("Existen campos obligatorios"),setTimeout(()=>{x("")},2e3)):(t(!0),T.current=!0,x(""))},mensajeError:f,esValido:o,valoresCambiados:j,valoresRef:O,validoRef:T}},me=l.memo(({virtualRow:g,filaFiltrada:f,isEven:x,isSelected:o,effectiveWidth:t,cabeceraFiltrada:j,onClick:L,onDoubleClick:O})=>e.jsx("div",{"data-row-index":g.index,onClick:L,onDoubleClick:O,className:`absolute left-0 flex border-b border-gray-200 cursor-pointer transition-colors duration-150 ${o?"bg-indigo-200":x?"bg-white":"bg-gray-50"} hover:bg-indigo-100 active:bg-indigo-300`,style:{transform:`translateY(${g.start}px)`,width:`${t}px`},children:f.map((T,N)=>e.jsx("div",{className:"px-2 py-2 text-left",style:{minWidth:`${j[N][1]}px`,flexShrink:0},children:T},N))})),re=({configTable:g,onSelect:f,rowsPerPage:x=20})=>{const{title:o,isPaginar:t,listaDatos:j,offsetColumnas:L}=g,O=j,T=l.useMemo(()=>j&&j.length>2?j.slice(2):[],[j]),[N,M]=l.useState(1),[V,H]=l.useState(null),[q,F]=l.useState(""),B=l.useRef(null);l.useEffect(()=>{B.current?.focus()},[]);const R=l.useMemo(()=>{if(!q.trim())return T;const u=q.toLowerCase();return T.filter(y=>y.toLowerCase().includes(u))},[T,q]),$=l.useMemo(()=>R.length,[R]);l.useEffect(()=>{M(1)},[]);const w=Math.max(1,Math.ceil(R.length/x));l.useEffect(()=>{t&&N>w&&M(w)},[t,N,w]);const i=(N-1)*x,r=i+x,d=R.slice(i,r),b=(u,y)=>{y>=1&&y<=w&&M(y)},p=l.useMemo(()=>(t?d:R).map(y=>{const W=y.split("|");return{completa:W,visible:W.slice(L)}}),[t,d,R,L]),{cabeceraFiltrada:k,totalWidth:I,rowVirtualizer:s,scrollBarRef:n,tableContainerRef:v,syncScroll:E}=ce(p,O,L);l.useEffect(()=>{if(!v.current)return;const u=new ResizeObserver(([y])=>{H(y.contentRect.width)});return u.observe(v.current),()=>u.disconnect()},[v]);const[z,U]=l.useState(null),K=l.useCallback(u=>{if(u.key==="Enter"&&document.activeElement===B.current){u.stopPropagation(),u.preventDefault();return}if(s.getTotalSize()!==0){if(u.key==="ArrowDown")U(y=>{const W=y===null?0:Math.min(y+1,s.getTotalSize()-1);return s.scrollToIndex(W,{align:"center",behavior:"smooth"}),W}),u.preventDefault();else if(u.key==="ArrowUp")U(y=>{const W=y===null?0:Math.max(y-1,0);return s.scrollToIndex(W,{align:"center",behavior:"smooth"}),W}),u.preventDefault();else if(u.key==="Enter"&&z!=null){const y=p[z];y&&f&&f(y.completa),u.preventDefault()}}},[s,z,p,f]);if(l.useEffect(()=>(window.addEventListener("keydown",K),()=>{window.removeEventListener("keydown",K)}),[K]),l.useEffect(()=>{z!=null&&s.scrollToIndex(z,{align:"center",behavior:"smooth"})},[z,s]),!j||j.length<=1)return e.jsx(le,{});const Y=V!=null?Math.max(V-32,I):I;return e.jsxs(e.Fragment,{children:[e.jsxs("div",{ref:v,className:"relative overflow-y-auto  min-h-0 bg-white shadow-lg rounded-lg border border-gray-200 outline-none",onScroll:()=>E("table"),tabIndex:0,children:[e.jsxs("div",{className:"sticky top-0 left-0 z-30 bg-white shadow-md",children:[e.jsxs("h2",{className:"text-left text-xl font-bold text-gray-800 py-2 px-4",children:[o," ",e.jsx("span",{className:"ml-2 text-sm font-medium text-gray-500",children:`(${$} Reg.)`})]}),e.jsx("div",{className:"px-4 pb-2",children:e.jsx("input",{type:"text",placeholder:"Buscar...",value:q,onChange:u=>F(u.target.value),onKeyDown:u=>{u.key==="Enter"&&(u.preventDefault(),u.stopPropagation(),v.current?.focus(),U(0))},ref:B,className:`w-full px-3 py-2 border border-gray-300 rounded-lg shadow-sm
                          focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500
                          text-sm text-gray-700`})})]}),e.jsx("div",{className:"sticky top-10 z-20 flex border-b border-gray-300 bg-gray-100",style:{width:`${Y}px`},children:k.map((u,y)=>e.jsx("div",{className:"px-2 py-2 font-semibold text-left",style:{minWidth:`${u[1]}px`,flexShrink:0},children:u[0]},y))}),e.jsx("div",{className:"relative",style:{height:t?`${s.getVirtualItems().length*35}px`:`${s.getTotalSize()}px`,width:`${Y}px`},children:s.getVirtualItems().map(u=>{const y=p[u.index];return y?e.jsx(me,{virtualRow:u,filaFiltrada:y.visible,isEven:u.index%2===0,isSelected:u.index===z,effectiveWidth:Y,cabeceraFiltrada:k,onClick:()=>{U(u.index),s.scrollToIndex(u.index,{align:"center",behavior:"smooth"})},onDoubleClick:()=>{U(u.index),y&&f&&f(y.completa)}},u.index):null})})]}),e.jsx("div",{ref:n,className:"fixed bottom-0 left-0 w-full h-5 overflow-x-auto bg-gray-100",onScroll:()=>E("bar"),children:e.jsx("div",{className:"h-1",style:{width:`${Y}px`}})}),t&&e.jsx(oe,{spacing:2,className:"mt-4 flex justify-center",children:e.jsx(ie,{count:w,page:N,onChange:b,shape:"rounded",color:"primary"})})]})},ae=g=>{let f;const x=new Set,o=(N,M)=>{const V=typeof N=="function"?N(f):N;if(!Object.is(V,f)){const H=f;f=M??(typeof V!="object"||V===null)?V:Object.assign({},f,V),x.forEach(q=>q(f,H))}},t=()=>f,O={setState:o,getState:t,getInitialState:()=>T,subscribe:N=>(x.add(N),()=>x.delete(N))},T=f=g(o,t,O);return O},ge=(g=>g?ae(g):ae),fe=g=>g;function he(g,f=fe){const x=Z.useSyncExternalStore(g.subscribe,Z.useCallback(()=>f(g.getState()),[g,f]),Z.useCallback(()=>f(g.getInitialState()),[g,f]));return Z.useDebugValue(x),x}const se=g=>{const f=ge(g),x=o=>he(f,o);return Object.assign(x,f),x},be=(g=>g?se(g):se),Q=be(g=>({selectedItems:[],setSelectedItems:f=>g({selectedItems:f})})),pe=l.forwardRef(({onClose:g,etiqueta:f,ancho:x,listaDatos:o,onChange:t,parentRef:j,url:L,offsetColumnas:O,triggerChange:T},N)=>{const M=l.useRef([]),[V]=l.useState({}),[H,q]=l.useState(!1),[F,B]=l.useState(!1),[R,$]=l.useState(""),[w,i]=l.useState(null),[r,d]=l.useState("success"),{runFetch:b}=de(),p=Q(C=>C.setSelectedItems);l.useEffect(()=>{const{selectedItems:C}=Q.getState();C||p([])},[]);const{handleClick:k,mensajeError:I,esValido:s,valoresCambiados:n}=ue(M),v=o?.[0],E=[],U=(typeof v=="string"?v.split("|"):[]).map((C,D)=>({data:E[D]??"",metadata:(C??"").split("*")})),K=U.map(({metadata:C})=>C[0]),u={default:(o??[]).slice(1)};l.useImperativeHandle(N,()=>({updateSelected(C,D){try{j&&j.current&&(j.current.dataset.value=C,j.current.dataset.label=D,j.current.value=C)}catch(S){console.log("Error al propagar al padre:",S)}}}));const y=l.useRef([]),W=l.useCallback(async()=>{if(!n.data.length&&!n.campos.length){$("NO existen datos que enviar"),d("error"),setTimeout(()=>$(""),2e3);return}const D=K.map(h=>{const P=n.campos.indexOf(h);return P!==-1?n.data[P]:""}).join("|"),S=new FormData;S.append("data",D),B(!0);try{const h=await b(L,{method:"POST",body:S});if(h){const P=h.split("~");P.length<=2?($("No se encontraron datos"),d("error"),q(!1)):($("Datos encontrados correctamente ..."),d("success"),q(!0),y.current=P)}}catch(h){console.error(h),$("Error al guardar la informacion ..."),d("error")}finally{B(!1),setTimeout(()=>{$("")},2e3)}},[b,n]);l.useEffect(()=>{s&&W()},[s,W]);const X={title:f,isPaginar:!0,listaDatos:y.current,offsetColumnas:O??1};return e.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-lg",style:{width:x?`${x}px`:"80vw"},children:[e.jsxs("h2",{className:"text-lg font-bold mb-4",children:["Busqueda de ",X.title]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:U.map((C,D)=>{const{data:S,metadata:h}=C,P=Number(h?.[5]??0);let G=h?.[3]?Number(h[3]):0;const a=h?.[1]==="0",c=h?.[8]==="1",m=h?.[14]==="1";G=h?.[4]===""?G:Number(h[4]);const A={1:"col-span-1",2:"col-span-2",3:"col-span-3",4:"col-span-4"};return e.jsx("div",{className:`${A[h?.[10]]??"col-span-1"} min-w-0`,children:e.jsx(ne,{ref:J=>M.current[D]=J,typeCode:P,etiqueta:h[7]??"",placeholder:h[7]??"",popupTipo:h[6]??"",style:m?{visibility:"hidden",position:"absolute",width:0,height:0,overflow:"hidden"}:{},...G>0?{maxLength:G}:{},...c?{disabled:!0}:{},...a?{required:!0}:{},...P===103?{checked:(V[h[0]]?.value??S)==="1"}:{},...h?.[2]==="1"&&P===101?{tipoDato:"entero"}:{},...h?.[2]==="2"&&P===101?{tipoDato:"decimal"}:{},...P===111?{defaultValue:u[h[6]]?.length>0?C.metadata[0]:"",...h?.[11]==="1"?{isDefault:1}:{},options:u.default}:P===151?{defaultValue:C.data,unaLinea:h?.[11],offsetColumnas:h?.[12],ancho:h?.[13]}:{defaultValue:C.data},dataAttrs:{value:V[h[0]]?.value??S,valor:S,campo:h[0],item:h[6]}},D)},D)})}),e.jsx("div",{className:"flex-shrink-0 mt-4",children:e.jsx(ne,{typeCode:120,onClick:k,...F?{disabled:!0}:{},children:F?"BUSCANDO...":"BUSCAR"})}),I&&r!=="success"&&e.jsx("div",{className:"mt-3 p-3 text-sm text-white bg-red-400 rounded-md shadow-md animate-bounce",children:I}),R&&r!=="success"&&e.jsx("div",{className:`mt-3 p-3 text-sm rounded-md shadow-md ${r==="success"?"bg-green-700 text-white animate-bounce":"bg-red-400 text-white animate-bounce"}`,children:R}),e.jsx("div",{className:"mb-4 flex-1 min-h-0 overflow-y-auto pr-2",children:H&&e.jsx("div",{style:{maxHeight:"50vh",overflowY:"auto",border:"1px solid #e5e7eb",borderRadius:"0.5rem"},children:e.jsx(re,{configTable:X,onSelect:C=>{const D=C[0],S=C[C.length-1];if(i({value:D,label:S}),p([C]),j&&j.current&&(j.current.dataset.value=D,j.current.dataset.label=S,j.current.value=D),T&&T(D,S),N&&N.current)try{N.current.dataset.value=D,N.current.dataset.label=S,N.current.value=D}catch(P){console.log(P)}t&&t({target:{value:D,dataset:{value:D},option:{value:D,label:S}}}),g()},rowsPerPage:10})})}),e.jsx("div",{className:"flex justify-end mt-4",children:e.jsx("button",{onClick:g,className:"bg-blue-300 hover:bg-blue-600 text-gray-800 px-4 py-2 rounded-md",children:"Cerrar"})})]})})}),ne=l.forwardRef(({typeCode:g,dataAttrs:f={},options:x=[],...o},t)=>{const j=l.useRef(null),[L,O]=l.useState(!1),[T,N]=l.useState(null),[M,V]=l.useState(!1),[H,q]=l.useState(!1),[F,B]=l.useState(null),[R,$]=l.useState("");Q(r=>r.selectedItems);const w=Object.entries(f).reduce((r,[d,b])=>(r[`data-${d}`]=b,r),{});if(g===100){const{value:r,campo:d,item:b}=f;return e.jsx("input",{type:"hidden",ref:t,"data-campo":d,"data-value":r,"data-item":b,value:r??"",defaultValue:r??""})}let i="div";if(g)switch(g){case 101:i="input",o.type="text";break;case 102:i="input",o.type="date";break;case 103:i="input",o.type="checkbox";break;case 104:i="input",o.type="radio";break;case 105:i="input",o.type="password";break;case 106:i="input",o.type="file";break;case 111:i="select";break;case 112:i="selectMulti";break;case 113:i="textArea";break;case 120:i="button";break;case 150:i="customPopupInputText";break;case 151:i="customPopupSelectMulti";break;default:i="div"}if(i==="input"){const{etiqueta:r,onChange:d,tipoDato:b,...p}=o;l.useEffect(()=>{t&&t.current&&w&&Object.entries(w).forEach(([s,n])=>{n!=null&&t.current.setAttribute(s,String(n))})},[w,t]);const k=s=>{let n=s.target.value;if(b==="entero")s.target.value=s.target.value.replace(/\D/g,"");else if(b==="decimal"){n=n.replace(/[^0-9.]/g,"");const v=n.split(".");v.length>2&&(n=v[0]+"."+v.slice(1).join(""))}else o.type==="text"&&(n=n.toUpperCase());s.target.value=n,o.type==="checkbox"||o.type==="radio"?s.target.dataset.value=s.target.checked?"1":"0":s.target.dataset.value=n,d&&d(s)},I=s=>{if(b==="entero"){const n=["Backspace","Delete","ArrowLeft","ArrowRight","Tab"];!/[0-9]/.test(s.key)&&!n.includes(s.key)&&s.preventDefault()}else if(b==="decimal"){const n=["Backspace","Delete","ArrowLeft","ArrowRight","Tab"];!/[0-9.]/.test(s.key)&&!n.includes(s.key)&&s.preventDefault(),s.key==="."&&s.currentTarget.value.includes(".")&&s.preventDefault()}};return o.type==="checkbox"||o.type==="radio"?e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{ref:t,type:o.type,...w,...p,defaultChecked:w["data-value"]==="1",onChange:k,className:`h-4 w-4 text-indigo-600 border-gray-300 rounded focus:ring-indigo-500 ${p.disabled?"opacity-50 cursor-not-allowed bg-gray-200":""}`}),e.jsxs("div",{className:"flex items-center gap-1 mb-1",children:[e.jsx("span",{className:"text-sm font-bold text-green-900",children:r}),p.required&&e.jsx("span",{className:"text-red-500",children:" *"})]})]}):e.jsxs("label",{className:"block w-full",style:p.style,children:[e.jsxs("div",{className:"flex items-center gap-1 mb-1",style:p.style,children:[e.jsxs("span",{className:"block text-sm font-bold text-green-900 mb-1",children:["Ingrese ",r?.replace(/nn/g,"ñ")]}),p.required&&e.jsx("span",{className:"text-red-500",children:" *"})]}),e.jsx("input",{ref:t,type:o.type,...w,...p,defaultValue:p.defaultValue,...o.type==="checkbox"?{checked:w["data-value"]==="1"}:{},onChange:k,onKeyDown:I,className:`block w-full rounded-md border bg-gray-50 px-3 py-2 shadow-sm placeholder-gray-400 focus:outline-none focus:ring-1 focus:ring-indigo-400 focus:border-indigo-400 border-gray-300 ${p.disabled?"opacity-50 cursor-not-allowed bg-gray-200 text-gray-800 font-bold":""}`})]})}if(i==="customPopupInputText"){const{etiqueta:r,popupContent:d,...b}=o;return e.jsxs("div",{className:"block w-full",children:[e.jsxs("label",{className:"block w-3/4 mb-1 px-3 rounded-md border border-gray-400 bg-indigo-50 hover:bg-indigo-100 text-sm font-bold text-green-900 cursor-pointer shadow-sm transition",onClick:()=>O(!0),children:[e.jsxs("span",{className:"text-sm font-bold text-green-900",children:[r," ( ... )"]}),b.required&&e.jsx("span",{className:"text-red-500",children:" *"})]}),e.jsx("input",{ref:t,type:"text",readOnly:!0,disabled:!0,...w,...b,defaultValue:b.defaultValue,className:"block w-full rounded-md border px-3 py-2 shadow-sm text-gray-600 opacity-50 cursor-not-allowed bg-gray-200"}),L&&e.jsx("div",{className:"fixed inset-0 flex items-center justify-center bg-white/0 backdrop-blur-sm z-50",children:e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-lg w-80",children:[e.jsx("h2",{className:"text-lg font-bold mb-4",children:"Título del Popup"}),e.jsx("div",{className:"mb-4",children:d??e.jsx("p",{children:"Aquí puedes mostrar más información."})}),e.jsx("button",{onClick:()=>O(!1),className:"bg-gray-300 hover:bg-gray-400 text-gray-800 px-4 py-2 rounded-md",children:"Cerrar"})]})})]})}if(i==="customPopupSelectMulti"){const{etiqueta:r,onChange:d,popupContent:b,unaLinea:p,offsetColumnas:k,ancho:I,isFilter:s,usarHardcodedExterno:n,onPopupClose:v,...E}=o,z=a=>{const c=Array.from(a.target.selectedOptions).map(m=>m.value);a.target.dataset.value=c.join(","),d&&d(a)},U=a=>{let c=[];if(a?.target?.selectedOptions)c=Array.from(a.target.selectedOptions).map(m=>m.value);else if(a?.target?.option){const{value:m,label:A,extra:J,descr:_}=a.target.option;if(c=[m],t&&t.current)try{t.current.value=m,t.current.dataset.value=m,t.current.dataset.label=A,t.current.dataset.extra=J??"",t.current.dataset.descr=_??""}catch(te){console.log(te)}}a.target.dataset.value=c.join(","),d&&d(a)},K=(()=>{if(typeof s=="string"&&s.trim()!==""){const a=x.filter(c=>{if(typeof c!="string")return!1;const m=c.split("|"),A=String(s).trim();return m[1]&&m[1].trim()===A});return a.length>0?[...x.slice(0,2),...a]:a}return x})(),Y=K.map(a=>{if(typeof a=="string"&&a.includes("|")){const c=a.split("|"),m=c[0],A=c[c.length-1]??c[0];return{value:String(m),label:String(A),raw:a,parts:c}}else if(typeof a=="object"&&a.value&&a.label){const c=a.raw??`${a.value}|${a.label}`,m=String(c).split("|");return{value:String(a.value??m[0]),label:String(a.label??m[m.length-1]),raw:c,parts:m}}else{const c=String(a),m=c.split("|");return{value:String(m[0]),label:m[m.length-1]??m[0],raw:c,parts:m}}}),u=String(w["data-value"]??"").trim(),y=String(w["data-valor"]??"").trim(),W=String(E.defaultValue??"").trim(),X=[u,y,W].filter(Boolean),C=a=>X.some(c=>String(a??"").trim()===String(c??"").trim()),D=Y.find(a=>a?!!(C(a.value)||Array.isArray(a.parts)&&a.parts.some(c=>C(c))):!1),S=T??D;l.useEffect(()=>{if(t&&t.current&&S)try{S.value!==void 0&&(t.current.dataset.value=String(S.value));const a=S.parts?.[2]??S.extra;a!==void 0&&(t.current.dataset.extra=String(a))}catch(a){console.log(a)}},[S,t]),l.useEffect(()=>{F?.value?$(F.value):$("")},[F]),l.useEffect(()=>{t&&typeof t=="function"&&t(j.current)},[t]),l.useEffect(()=>{typeof n=="boolean"&&q(n)},[n]);const h=p==="1"?{height:"2.7rem"}:{height:"10rem"},P={title:r,isPaginar:!0,listaDatos:K,offsetColumnas:k??1},G=I?`${I}px`:"600px";return e.jsxs("div",{className:"block w-full",children:[e.jsxs("label",{className:"block w-3/4 mb-1 px-3 rounded-md border border-gray-400 bg-indigo-50 hover:bg-indigo-100 text-sm font-bold text-green-900 cursor-pointer shadow-sm transition",onClick:a=>{if(o.popupTipo?.startsWith("99")){V(!0);return}if((o.onPopupClick?o.onPopupClick(a):!0)===!1){O(!1);return}O(!0)},children:[e.jsxs("span",{className:"text-sm font-bold text-green-900",children:[r," ( ... )"]}),E.required&&e.jsx("span",{className:"text-red-500",children:" *"})]}),e.jsx("select",{ref:t,multiple:!0,readOnly:!0,disabled:!0,...w,...E,"data-value":R||S?.value||w["data-value"],onChange:z,style:h,className:"block w-full rounded-md border  px-3 py-2 shadow-sm opacity-50 cursor-not-allowed bg-gray-200 text-gray-700 font-bold",children:E.forcedOption&&E?.optionFlag===1?e.jsx("option",{value:E.forcedOption.value,style:{fontWeight:"bold",color:"black"},children:E.forcedOption.label},E.forcedOption.value):H&&F?e.jsx("option",{value:F.value,style:{fontWeight:"bold",color:"black"},children:F.label},F.value):S?e.jsx("option",{value:S.value,style:{fontWeight:"bold",color:"black"},children:S.label},S.value):null}),L&&e.jsx("div",{className:"fixed inset-0 flex items-center justify-center bg-white/0 backdrop-blur-sm z-50",tabIndex:-1,onKeyDown:a=>{if(a.key==="Escape"){if(o.onPopupClose&&L)try{o.onPopupClose("cerrar",null)}catch(c){console.warn(c)}O(!1)}},children:e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-lg max-h-[80vh] flex flex-col overflow-y-auto",style:{width:G},children:[e.jsx("div",{className:"mb-4 flex-1 min-h-0 overflow-y-auto pr-2",children:b??e.jsx(re,{configTable:P,onSelect:a=>{const c=a[0],m=a?.[2]??"",A=a?.[3]??"",J=a[a.length-1],{setSelectedItems:_}=Q.getState();if(_([a]),N({value:c,label:J,extra:m,descr:A}),typeof v=="function")try{o.onPopupClose("fila",c)}catch(ee){console.warn(ee)}if(t&&t.current)try{t.current.dataset.value=c,t.current.dataset.extra=m,t.current.dataset.descr=A,t.current.value=c}catch(ee){console.log(ee)}d&&d({target:{value:c,dataset:{value:c,extra:m,descr:A},option:{value:c,label:J,extra:m,descr:A}}}),O(!1)}})}),e.jsx("div",{className:"bg-gray-300 hover:bg-gray-400 text-gray-800 px-4 py-2 rounded-md flex justify-end",children:e.jsx("button",{onClick:()=>{if(o.onPopupClose)try{o.onPopupClose("cerrar",null)}catch(a){console.warn(a)}O(!1)},className:"bg-gray-300 hover:bg-gray-400 text-gray-800 px-4 py-2 rounded-md",children:"Cerrar"})})]})}),M&&e.jsx(pe,{onClose:()=>{const{selectedItems:a}=Q.getState();V(!1),setTimeout(()=>{if(a&&a.length>0){const c=a[0],m=c[0]??"",A=c[1]??"";E.setOptionFlag(0),q(!0),B({value:m??"",label:A??""}),t?.current&&(t.current.dataset.value=m??"",t.current.dataset.label=A??"",t.current.value=m??"",$(m??"")),o.onPopupClose?.("cerrar",null)}},0)},etiqueta:r,ancho:I,listaDatos:x,onChange:U,parentRef:t,ref:t,url:o.url,offsetColumnas:k,triggerChange:(a,c)=>{if(t&&t.current&&(t.current.dataset.value=a,t.current.dataset.label=c,t.current.value=a,d)){const m={target:t.current};d(m)}}})]})}if(i==="select"){const{etiqueta:r,onChange:d,children:b,isDefault:p,...k}=o,I=n=>{const v=n.target.value;n.target.dataset.value=v,d&&d(n)},s=n=>{if(t&&(typeof t=="function"?t(n):t.current=n),n&&n.options.length>0){const v=n.dataset.value||n.value;Array.from(n.options).some(z=>z.value===v)||(n.selectedIndex=0,n.dataset.value=n.options[0].value,n.dataset.valor=n.options[0].value)}};return e.jsxs("label",{className:"block w-full",children:[r&&e.jsxs("div",{className:"flex items-center gap-1 mb-1",children:[e.jsxs("span",{className:"block text-sm font-bold text-green-900 mb-1",children:["seleccione ",r]}),k.required&&e.jsx("span",{className:"text-red-500",children:" *"})]}),e.jsxs("select",{ref:s,...w,...k,defaultValue:p===1?x?.[0]?.split("|")[0]??"":w["data-value"]??"",onChange:I,className:`block w-full rounded-md border bg-gray-50 px-3 py-2 shadow-sm placeholder-gray-400 focus:outline-none focus:ring-1 focus:ring-indigo-400 focus:border-indigo-400 border-gray-300 ${k.disabled?"opacity-50 cursor-not-allowed bg-gray-200 text-gray-700 font-bold":""}`,children:[p!==1&&e.jsx("option",{value:"",disabled:!0,children:"Seleccione --"}),b??x.map((n,v)=>{const[E,z]=n.split("|");return e.jsx("option",{value:E,children:z},v)})]})]})}if(i==="selectMulti"){const{etiqueta:r,onChange:d,children:b,unaLinea:p,...k}=o,I=n=>{const v=Array.from(n.target.selectedOptions).map(E=>E.value);n.target.dataset.value=v.join(","),d&&d(n)},s=p==="1"?{height:"2.7rem"}:{height:"10rem"};return e.jsxs("label",{className:"block w-full",children:[r&&e.jsxs("div",{className:"flex items-center gap-1 mb-1",children:[e.jsxs("span",{className:"block text-sm font-bold text-green-900 mb-1",children:["seleccione ",r]}),k.required&&e.jsx("span",{className:"text-red-500",children:" *"})]}),e.jsx("select",{ref:t,multiple:!0,style:s,...w,...k,onChange:I,className:`block w-full rounded-md border bg-gray-50 px-3 py-2 shadow-sm text-gray-600 focus:outline-none focus:ring-1 focus:ring-indigo-400 focus:border-indigo-400 border-gray-300 ${k.disabled?"opacity-50 cursor-not-allowed bg-gray-200 text-gray-500":""}`,children:b??x.map(({value:n,label:v},E)=>e.jsx("option",{value:n,children:v},E))})]})}if(i==="textArea"){const{etiqueta:r,onChange:d,...b}=o,p=k=>{k.target.dataset.value=k.target.value,d&&d(k)};return e.jsxs("label",{className:"block w-full",children:[r&&e.jsxs("div",{className:"flex items-center gap-1 mb-1",children:[e.jsx("span",{className:"block text-sm font-bold text-green-900 mb-1",children:r}),b.required&&e.jsx("span",{className:"text-red-500",children:" *"})]}),e.jsx("textarea",{ref:t,...w,...b,onChange:p,defaultValue:b.defaultValue,className:`block w-full rounded-md border bg-gray-50 px-3 py-2 shadow-sm placeholder-gray-400 focus:outline-none focus:ring-1 focus:ring-indigo-400 focus:border-indigo-400 border-gray-300 ${b.disabled?"opacity-50 cursor-not-allowed bg-gray-200 text-gray-500":""}`})]})}if(i==="button"){const{etiqueta:r,children:d,onClick:b,style:p={},isEdit:k=!0,...I}=o,s=!k;return e.jsxs("div",{className:"inline-block w-full",children:[r&&e.jsx("span",{className:"block text-sm font-bold text-green-900 mb-1",children:r}),e.jsx("button",{ref:t,...w,...I,onClick:b,style:p,className:`
                      px-4 py-2 rounded-md shadow-sm
                      ${s?"bg-gray-300 text-gray-600  cursor-not-allowed opacity-50":"bg-indigo-500 text-white hover:bg-indigo-600 cursor-pointer"}
                    `,children:d})]})}});export{ne as C,ue as a,Q as u};
